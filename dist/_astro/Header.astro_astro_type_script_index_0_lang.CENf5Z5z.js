const l=document.getElementById("nav-toggle"),c=document.getElementById("nav-menu"),s=document.getElementById("theme-toggle"),i=document.getElementById("theme-toggle-desktop");function w(){l&&l.classList.toggle("active"),c&&c.classList.toggle("active"),document.body.style.overflow=c&&c.classList.contains("active")?"hidden":""}l&&l.addEventListener("click",w);c&&c.addEventListener("click",a=>{a.target instanceof HTMLAnchorElement&&window.innerWidth<=768&&(l&&l.classList.remove("active"),c.classList.remove("active"),document.body.style.overflow="")});document.addEventListener("click",a=>{const e=a.target;e instanceof Node&&l&&c&&s&&!l.contains(e)&&!c.contains(e)&&!s.contains(e)&&(l.classList.remove("active"),c.classList.remove("active"),document.body.style.overflow="")});window.addEventListener("resize",()=>{window.innerWidth>768&&(l&&l.classList.remove("active"),c&&c.classList.remove("active"),document.body.style.overflow="")});function E(){const a=localStorage.getItem("theme"),e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=a==="dark"||!a&&e;document.documentElement.classList.toggle("dark",t),s&&s.classList.toggle("dark",t),i&&i.classList.toggle("dark",t),s&&s.setAttribute("aria-label",t?"Açık moda geç":"Koyu moda geç"),i&&i.setAttribute("aria-label",t?"Açık moda geç":"Koyu moda geç")}function y(){const e=document.documentElement.classList.contains("dark")?"light":"dark";document.documentElement.classList.toggle("dark",e==="dark"),s&&s.classList.toggle("dark",e==="dark"),i&&i.classList.toggle("dark",e==="dark"),localStorage.setItem("theme",e),s&&s.setAttribute("aria-label",e==="dark"?"Açık moda geç":"Koyu moda geç"),i&&i.setAttribute("aria-label",e==="dark"?"Açık moda geç":"Koyu moda geç")}E();s&&s.addEventListener("click",y);i&&i.addEventListener("click",y);window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>{localStorage.getItem("theme")||(document.documentElement.classList.toggle("dark",a.matches),s&&s.classList.toggle("dark",a.matches),i&&i.classList.toggle("dark",a.matches),s&&s.setAttribute("aria-label",a.matches?"Açık moda geç":"Koyu moda geç"),i&&i.setAttribute("aria-label",a.matches?"Açık moda geç":"Koyu moda geç"))});class b{constructor(){this.posts=[],this.locale=document.documentElement.lang||"tr",this.loadPosts().then(()=>{this.initializeSearch()})}async loadPosts(){try{const e=await fetch(`/api/posts.json?locale=${this.locale}`);e.ok?this.posts=await e.json():(console.warn("Could not load posts, using fallback"),this.posts=[])}catch(e){console.warn("Error loading posts:",e),this.posts=[]}}initializeSearch(){document.querySelectorAll(".modern-search").forEach(e=>{const t=e.querySelector(".search-input"),n=e.querySelector(".search-results"),r=e.querySelector(".search-clear");!t||!n||!r||this.setupEventListeners(t,n,r,e)})}setupEventListeners(e,t,n,r){e.addEventListener("input",h=>{const m=e.value.trim();m?(n.style.display="flex",this.performSearch(m,t)):(n.style.display="none",this.hideResults(t))}),n.addEventListener("click",()=>{e.value="",n.style.display="none",this.hideResults(t),e.focus()}),e.addEventListener("focus",()=>{e.value.trim()&&this.performSearch(e.value.trim(),t)}),document.addEventListener("click",h=>{const m=h.target;m instanceof Node&&(r.contains(m)||this.hideResults(t))}),e.addEventListener("keydown",h=>{h.key==="Escape"&&(this.hideResults(t),e.blur())})}performSearch(e,t){const n=String(e).toLowerCase(),r=n.startsWith("#")?n.slice(1).trim():n.trim(),m=r.replace(/\s+/g," ").replace(/\s+/g,"-"),k=this.posts.filter(d=>{const o=(d.title||"").toLowerCase().includes(r),g=(d.description||"").toLowerCase().includes(r),f=Array.isArray(d.tags)&&d.tags.some(v=>{const u=String(v||"").toLowerCase(),L=u.replace(/-/g," ");return u.includes(r)||L.includes(r)||u.includes(m)});return o||g||f});if(t.innerHTML="",k.length){const d=this.locale==="en"?"/en/":"/";k.slice(0,8).forEach(o=>{const g=document.createElement("a");g.className="search-result",g.href=`${d}${o.slug}/`,g.setAttribute("role","option");const f=o.heroImage?`<div class="search-thumb"><img src="${o.heroImage}" alt="" loading="lazy"/></div>`:"",v=`<div class="search-result-title">${o.title||""}</div>`,u=o.description?`<div class="search-result-desc">${o.description}</div>`:"";g.innerHTML=`
            <div class="search-result-row">
              ${f}
              <div class="search-result-content">
                ${v}
                ${u}
              </div>
            </div>
          `,t.appendChild(g)})}else{const d=this.locale==="en"?"No results found":"Sonuç bulunamadı",o=document.createElement("div");o.className="search-result",o.textContent=d,t.appendChild(o)}this.showResults(t)}showResults(e){e.style.display="block",e.classList.add("open")}hideResults(e){e.style.display="none",e.classList.remove("open")}}new b;
