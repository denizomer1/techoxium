---
const rawDate = Astro.props?.date;

// normalize to Date object when possible
let dateObj: Date | null = null;
if (rawDate) {
	dateObj = rawDate instanceof Date ? rawDate : new Date(rawDate as any);
	if (Number.isNaN(dateObj.getTime())) dateObj = null;
}

function formatDate(d: Date) {
	try {
		return new Intl.DateTimeFormat('en-US', {
			year: 'numeric',
			month: 'short',
			day: 'numeric',
		}).format(d);
	} catch (e) {
		return d.toDateString();
	}
}

---

{dateObj ? (
	<time datetime={dateObj.toISOString()}>{formatDate(dateObj)}</time>
) : (
	<!-- empty or invalid date -->
	<span aria-hidden="true"></span>
)}
