---
import HeaderLink from './HeaderLink.astro';
import Search from './Search.astro';
---

<header>
   <nav>
	   <h2>
		   <a href="/" class="logo-link" aria-label="Techoxium home">
			   <img src="/logo.png" alt="Techoxium" class="site-logo" loading="lazy" decoding="async" onerror="this.style.display='none'; const t=this.nextElementSibling; if(t) t.style.display='inline-block';" />
			   <span class="logo-text" style="display:none; font-weight:700;">Techoxium</span>
		   </a>
	   </h2>
	   <button class="nav-toggle" aria-expanded="false" aria-label="Toggle navigation">☰</button>
	   <div class="internal-links">
		   <Search />
	   </div>
		<button class="dark-toggle" aria-label="Koyu modu aç/kapat">🌙</button>
   </nav>
</header>
<style>
header {
	margin: 0;
	padding: 0 1em;
	background: var(--header-bg, rgba(255,255,255,0.85));
	backdrop-filter: blur(6px);
	-webkit-backdrop-filter: blur(6px);
	box-shadow: 0 6px 24px rgba(2,6,23,0.08);
	transition: background 240ms ease, color 240ms ease;
	position: sticky;
	top: 0;
	z-index: 80;
}

h2 { margin: 0; }

.logo-link { display: inline-flex; align-items: center; gap: 0.5rem; }

nav { display: flex; align-items: center; justify-content: space-between; gap: 1rem; }

.internal-links { display: flex; gap: 0.5rem; align-items: center; }
.internal-links a { padding: 0.5rem 0.5rem; border-radius: 8px; transition: background 180ms, color 180ms; }
.internal-links a:hover { background: rgba(0,0,0,0.04); }

.nav-toggle { display: none; }

.dark-toggle { background: none; border: none; font-size: 1.1rem; cursor: pointer; padding: 0.4rem; border-radius: 8px; }
.dark-toggle:hover { background: rgba(0,0,0,0.04); }

.site-logo { height: 2.25rem; max-height: 48px; width: auto; display: block; vertical-align: middle; object-fit: contain; }
.logo-text { display: none; color: var(--nav-link, var(--black)); font-size: 1rem; line-height: 1; }

@media (max-width: 720px) {
	.nav-toggle { display: inline-flex; align-items:center; justify-content:center; padding:0.5rem 0.75rem; font-size:1.25rem; }
	.internal-links { display: none; position: absolute; top: 64px; right: 8px; background: var(--header-bg, rgba(255,255,255,0.98)); box-shadow: 0 8px 24px rgba(2,6,23,0.12); border-radius: 8px; padding: 0.5rem 0.75rem; }
	.internal-links.show { display: block; }
}

:root, body { --header-bg: rgba(255,255,255,0.85); --nav-link: var(--black); }
body.dark { --header-bg: rgba(20,20,22,0.6); --nav-link: #f3f3f3; }
</style>

<script>
// Theme + mobile nav (small self-executing module)
(() => {
	if (!globalThis.document) return;
	const d = globalThis.document;
	const btn = d.querySelector('.dark-toggle');
	const media = globalThis.matchMedia && globalThis.matchMedia('(prefers-color-scheme: dark)');
	const pref = () => { const v = globalThis.localStorage?.getItem('theme'); return v === 'dark' || v === 'light' ? v : null; };
	const effective = () => pref() || (media && media.matches ? 'dark' : 'light');
	const apply = (m) => d.body.classList.toggle('dark', m === 'dark');
	const update = () => { if(!btn) return; const dark = d.body.classList.contains('dark'); btn.textContent = dark ? '☀️' : '🌙'; btn.setAttribute('aria-label', dark ? 'Açık moda geç' : 'Koyu moda geç'); };
	apply(effective()); update();
	media && media.addEventListener('change', () => { if (!pref()) { apply(effective()); update(); } });
	btn && btn.addEventListener('click', () => { const next = effective() === 'dark' ? 'light' : 'dark'; globalThis.localStorage?.setItem('theme', next); apply(next); update(); });
	const navBtn = d.querySelector('.nav-toggle');
	const links = d.querySelector('.internal-links');
		navBtn && links && navBtn.addEventListener('click', () => { const expanded = navBtn.getAttribute('aria-expanded') === 'true'; navBtn.setAttribute('aria-expanded', globalThis.String(!expanded)); links.classList.toggle('show'); });
})();
</script>
