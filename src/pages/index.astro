---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';
import PostCard from '../components/PostCard.astro';

const rawPosts = await getCollection('blog');
const posts = rawPosts
	.map((p) => ({
		...p,
		data: { ...p.data, pubDate: p.data.pubDate instanceof Date ? p.data.pubDate : new Date(p.data.pubDate as any) },
	}))
	.sort((a, b) => Number(b.data.pubDate) - Number(a.data.pubDate));
const [firstPost, ...restPosts] = posts;
---

<html lang="tr">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<h1>Blog Yazıları</h1>
			<section>
				{firstPost && (
					<div class="featured-list">
						<PostCard
							href={`/${firstPost.id}/`}
							title={firstPost.data.title}
							description={firstPost.data.description}
							pubDate={firstPost.data.pubDate}
							heroImage={firstPost.data.heroImage}
							large={true}
						/>
					</div>
				)}
				<div class="post-list grid grid-2">
					{restPosts.map((post) => (
						<PostCard
							href={`/${post.id}/`}
							title={post.data.title}
							description={post.data.description}
							pubDate={post.data.pubDate}
							heroImage={post.data.heroImage}
						/>
					))}
				</div>
			</section>
		</main>
		<Footer />
	</body>
</html>

<style>
	.featured-list { 
		margin: 0 0 2rem; 
	}
	
	.featured-list .post-card { 
		box-shadow: 0 14px 46px -10px rgba(var(--gray), 25%), 0 8px 22px -8px rgba(var(--gray), 12%); 
	}
</style>
